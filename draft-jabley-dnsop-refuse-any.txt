


Network Working Group                                           J. Abley
Internet-Draft                                                 Dyn, Inc.
Updates: 1035 (if approved)                               O. Gudmundsson
Intended status: Standards Track                            M. Majkowski
Expires: April 2, 2016                                   CloudFlare Inc.
                                                      September 30, 2015


    Providing Minimal-Sized Responses to DNS Queries with QTYPE=ANY
                    draft-jabley-dnsop-refuse-any-00

Abstract

   The Domain Name System (DNS) specifies a query type (QTYPE) "ANY".
   The operator of an authoritative DNS server might choose not to
   respond to such queries for reasons of local policy, motivated by
   security, performance or other reasons.

   The DNS specification does not include specific guidance for the
   behaviour of DNS servers or clients in this situation.  This document
   aims to provide such guidance.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on April 2, 2016.

Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents



Abley, et al.             Expires April 2, 2016                 [Page 1]

Internet-Draft      Minimal Responses for ANY Queries     September 2015


   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.


Table of Contents

   1.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . ancho
   2.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . ancho
   3.  Motivations . . . . . . . . . . . . . . . . . . . . . . . . ancho
   4.  General Approach  . . . . . . . . . . . . . . . . . . . . . ancho
   5.  Behaviour of DNS Responders . . . . . . . . . . . . . . . . respo
   6.  Behaviour of DNS Initiators . . . . . . . . . . . . . . . . ancho
   7.  HINFO Considerations  . . . . . . . . . . . . . . . . . . . ancho
   8.  Changes to RFC 1035 . . . . . . . . . . . . . . . . . . . . ancho
   9.  Security Considerations . . . . . . . . . . . . . . . . . . ancho
   10. IANA Considerations . . . . . . . . . . . . . . . . . . . . ancho
   11. Acknowledgements  . . . . . . . . . . . . . . . . . . . . . ancho
   12. References  . . . . . . . . . . . . . . . . . . . . . . . . ancho
     12.1.  Normative References . . . . . . . . . . . . . . . . . ancho
     12.2.  Informative References . . . . . . . . . . . . . . . . ancho
   Appendix A.  Editorial Notes  . . . . . . . . . . . . . . . . . ancho
     A.1.   Venue  . . . . . . . . . . . . . . . . . . . . . . . . ancho
     A.2.   Change History . . . . . . . . . . . . . . . . . . . . ancho
       A.2.1.  draft-jabley-dnsop-ordered-answers-00 . . . . . . . ancho
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . .     0























Abley, et al.             Expires April 2, 2016                 [Page 2]

Internet-Draft      Minimal Responses for ANY Queries     September 2015


1.  Terminology

   This document uses terminology specific to the Domain Name System
   (DNS), descriptions of which can be found in
   [I-D.ietf-dnsop-dns-terminology].

   In this document, "ANY Query" refers to a DNS query with QTYPE=ANY.
   An "ANY Response" is a response to such a query.

   In an exchange of DNS messages between two hosts, this document
   refers to the host sending a DNS request as the initiator, and the
   host sending a DNS response as the responder.

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY" and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].



































Abley, et al.             Expires April 2, 2016                 [Page 3]

Internet-Draft      Minimal Responses for ANY Queries     September 2015


2.  Introduction

   The Domain Name System (DNS) specifies a query type (QTYPE) "ANY".
   The operator of an authoritative DNS server might choose not to
   respond to such queries for reasons of local policy, motivated by
   security, performance or other reasons.

   The DNS specification [RFC1034] [RFC1035] does not include specific
   guidance for the behaviour of DNS servers or clients in this
   situation.  This document aims to provide such guidance.









































Abley, et al.             Expires April 2, 2016                 [Page 4]

Internet-Draft      Minimal Responses for ANY Queries     September 2015


3.  Motivations

   ANY queries are legitimately used for debugging and checking the
   state of a DNS server for a particular owner name.  ANY queries are
   sometimes used as a attempt to reduce the number of queries needed to
   get information, e.g. to obtain MX, A and AAAA RRSets for a mail
   domain in a single query, although there is no documented guidance
   available for this use case and some implementations have been
   observed that appear not to function as perhaps their developers
   expected.

   ANY queries are also frequently used to exploit the amplification
   potential of DNS servers using spoofed source addresses and UDP
   transport (see [RFC5358]).  Having the ability to return small
   responses to such queries makes DNS servers less attractive
   amplifiers.

   ANY queries are sometimes used to help mine authoritative-only DNS
   servers for zone data, since they return all RRSets for a particular
   owner name.  A DNS zone maintainer might prefer not to send
   conventional ANY responses to reduce the potential for such
   information leaks.

   Some authoritative-only DNS server implementations require additional
   processing in order to send a conventional ANY response, and avoiding
   that processing expense may be desirable.

























Abley, et al.             Expires April 2, 2016                 [Page 5]

Internet-Draft      Minimal Responses for ANY Queries     September 2015


4.  General Approach

   This proposal provides a mechanism for an authority server to signal
   that conventional ANY queries are not supported for a particular
   QNAME, and to do so in such a way that is both compatible with and
   triggers desirable behaviour by unmodified clients (e.g.  DNS
   resolvers).

   Alternative proposals for dealing with ANY queries have been
   discussed.  One approach proposed using a new RCODE to signal that an
   authortitaive server did not answer ANY queries in the standard way.
   This approach was found to have an undesirable effect on both
   resolvers and authoritative-only servers; resolvers receiving an
   unknown RCODE caused them to re-send the same query to all available
   authoritative servers, rather than suppress future such ANY queries
   for the same QNAME.

   This proposal avoids that outcome by returning a non-empty RRSet in
   the ANY response, providing resolvers with something to cache and
   effectively suppressing repeat queries to the same or different
   authority servers.

   This proposal makes use of the HINFO RRType rather than specifying a
   new RRType.  This is intended both to facilitate desired behaviour by
   initators who might otherwise struggle to deal correctly with new
   RRTypes, but also because in a general sense the signalling from
   responder to initiator is providing some information about the
   responding host, which seems in keeping with the originally-imagined
