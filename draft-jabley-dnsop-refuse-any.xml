<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
  <!ENTITY rfc1034 PUBLIC ''
    'http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.1034.xml'>
  <!ENTITY rfc1035 PUBLIC ''
    'http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.1035.xml'>
  <!ENTITY rfc2119 PUBLIC ''
    'http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml'>
  <!ENTITY I-D.ietf-dnsop-dns-terminology PUBLIC ''
    'http://xml2rfc.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-dnsop-dns-terminology.xml'>
]>

<rfc category="std" ipr="trust200902" updates="1035"
  docName="draft-jabley-dnsop-refuse-any-00">

  <?rfc toc="yes" ?>
  <?rfc symrefs="yes" ?>
  <?rfc sortrefs="yes"?>
  <?rfc iprnotified="no" ?>
  <?rfc strict="yes" ?>

  <front>
    <title>Signalling Refusal to Answer DNS Queries</title>

    <author initials='J.' surname="Abley" fullname='Joe Abley'>
      <organization>Dyn, Inc.</organization>
      <address>
        <postal>
          <street>103-186 Albert Street</street>
          <city>London</city>
          <region>ON</region>
          <code>N6A 1M1</code>
          <country>Canada</country>
        </postal>
        <phone>+1 519 670 9327</phone>
        <email>jabley@dyn.com</email>
      </address>
    </author>

    <author initials="O." surname="Gudmundsson" fullname="Olafur Gudmundsson">
      <organization>CloudFlare Inc.</organization>
      <address>
        <postal>
          <city>San Francisco</city>
          <region>CA</region>
          <code>94107</code>
          <country>USA</country>
        </postal>
        <email>olafur@cloudflare.com</email>
      </address>
    </author>

    <author initials="M." surname="Majkowski" fullname="Marek Majkowski">
      <organization>CloudFlare Inc.</organization>
      <address>
        <postal>
          <city>London</city>
          <country>UK</country>
        </postal>
        <email>marek@cloudflare.com</email>
      </address>
    </author>

    <date day="19" month="August" year="2015"/>

    <abstract>
      <t>The Domain Name System (DNS) supports queries that the
	operator of an authoritative DNS server might choose not
	to respond to, such as queries with QTYPE "ANY", or QTYPE
	"RRSIG".  Such local policy might be motivated by a desire
	to reduce the amplification potential of a DNS server, or
	to optimise nameserver performance.</t>

      <t>The DNS specification does not include specific guidance
	for the behaviour of DNS servers or clients in this situation,
        and as a result there is no clear

      <t>This document describes a standard way to 

      <t>In the event that a DNS operator institutes such a local policy,
        this document describes 

      <t>This document updates RFC 1034 and RFC 1035 to provide
        a clear specification, consistent with deployed code.</t>
    </abstract>
  </front>

  <middle>
    <section title="Terminology">
      <t>This document uses terminology specific to the Domain Name
        System (DNS), descriptions of which can be found in
        <xref target="I-D.ietf-dnsop-dns-terminology"/>.</t>

      <t>In an exchange of DNS messages between two hosts, this document
        refers to the host sending a DNS request as the initiator, and
        the host sending a DNS response as the responder.</t>

      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
        "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY"
        and "OPTIONAL" in this document are to be interpreted as
        described in <xref target="RFC2119"/>.</t>
    </section>


    <section title="Introduction">
      <t><xref target="RFC1034"/> specifies an algorithm for use by
        responders when constructing a DNS response. This algorithm
        in some cases can result in multiple RRSets being included
        in the answer section, e.g. when handling CNAME resource
        records.</t>

      <t>Many responder implementations [citation needed] have
	interpreted the direction to copy or store particular RRSets
	in the answer section of a DNS response to mean "append",
        treating the answer section as an ordered list of RRSets,
	and some initiators [citation needed] are known to rely
	upon that interpretation.</t>

      <t>This document updates <xref target="RFC1035"/> to specify
        that the answer section is an ordered list of RRSets, and
        clarifies the algorithm specified in <xref target="RFC1034"/>
        section 4.3.2 to match the observed behaviour and expectations
        of deployed software.</t>
    </section>

    <section title="Updates to RFC 1034" anchor="algorithm">
      <t><xref target="RFC1034"/> section 4.3.2 specifies the
        algorithm by which an answer section of a DNS response
        is constructed by a responder. The following clarifications
        relate to the steps described in that section.</t>

      <t>
        <list style="hanging">
          <t hangText="Step 3(a):">The word "copy" should be
            interpreted in every case as meaning that the resource
            records specified are to be appended to the answer section
            of the DNS response under construction.</t>

          <t hangText="Step 3(c):">The word "copy" in the final
            paragraph, the word "copy" should be interpreted in the
            same way as described above.</t>

          <t hangText="Step 4:">The word "copy" should be
            interpreted in the same way as described above.</t>

          <t hangText="Step 5:">The word "store" should be
            interpreted in the same way as described for the word
            "copy", above.</t>
	</list>
      </t>
    </section>

    <section title="Updates to RFC 1035">
      <t>In a DNS message, the answer section MUST be considered to be
        an ordered set of resource records.</t>

      <t>DNS responders MUST construct the answer
        section in a DNS response according to the algorithm specified
        in <xref target="RFC1034"/> section 4.3.2, as updated by
        <xref target="algorithm"/> of this document.</t>

      <t>DNS initiators that receive a DNS response with an answer
        section that is ordered differently to this specification SHOULD
        discard the response and continue as if no response was
        received.</t>
    </section>

    <section title="Security Considerations">
      <t>The recommendations contained in this document have no
        known security implications.</t>
    </section>

    <section title="IANA Considerations">
      <t>This document has no IANA actions.</t>
    </section>

    <section title="Acknowledgements">
      <t>Your name here, etc.</t>
    </section>
  </middle>

  <back>
    <references title="Normative References">
      &rfc1034;
      &rfc1035;
      &rfc2119;
    </references>

    <references title="Informative References">
      &I-D.ietf-dnsop-dns-terminology;
    </references>

    <section title="Editorial Notes">
      <t>This section (and sub-sections) to be removed prior to
        publication.</t>

      <section title="Venue">
        <t>An appropriate forum for discussion of this draft is
          the dnsop working group.</t>
      </section>

      <section title="Change History">
        <section title="draft-jabley-dnsop-ordered-answers-00">
          <t>Initial draft circulated for comment.</t>
        </section>
      </section>
    </section>
  </back>
</rfc>

